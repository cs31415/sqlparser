using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace sqlparser
{
    class SqlUtils
    {
        public static bool IsBuiltInFunction(string func)
        {
            // TODO flesh out

            var builtin = new HashSet<string>
            {
                "ascii",
                "char",
                "charindex",
                "concat",
                "concat_ws",
                "difference",
                "format",
                "left",
                "len",
                "lower",
                "ltrim",
                "nchar",
                "patindex",
                "quotename",
                "replace",
                "replicate",
                "reverse",
                "right",
                "rtrim",
                "soundex",
                "space",
                "str",
                "string_agg",
                "string_escape",
                "string_split",
                "stuff",
                "substring",
                "translate",
                "trim",
                "unicode",
                "upper",
                "approx_count_distinct",
                "min",
                "avg",
                "stdev",
                "checksum_agg",
                "stdevp",
                "count",
                "string_agg",
                "count_big",
                "sum",
                "groupingvar",
                "grouping_id",
                "varp",
                "max",
                "cume_dist",
                "lead",
                "first_value",
                "percentile_cont",
                "lag",
                "percentile_disc",
                "last_value",
                "percent_rank",
                "cast",
                "convert",
                "parse",
                "try_cast",
                "try_convert",
                "try_parse",
                "@@cursor_rows",
                "cursor_status",
                "@@fetch_status",
                "datalength",
                "ident_seed",
                "ident_current",
                "identity",
                "ident_incr",
                "sql_variant_property",
                "sysdatetime",
                "sysdatetimeoffset",
                "sysutcdatetime",
                "current_timestamp",
                "getdate",
                "getutcdate",
                "datename",
                "datepart",
                "day",
                "month",
                "year",
                "datefromparts",
                "datetime2fromparts",
                "datetimefromparts",
                "datetimeoffsetfromparts",
                "smalldatetimefromparts",
                "timefromparts",
                "datediff",
                "datediff_big",
                "dateadd",
                "eomonth",
                "switchoffset",
                "todatetimeoffset",
                "@@datefirst",
                "set datefirst",
                "set dateformat",
                "@@language",
                "set language",
                "isdate",
                "isjson",
                "json_value",
                "json_query",
                "json_modify",
                "abs",
                "degrees",
                "rand",
                "acos",
                "exp",
                "round",
                "asin",
                "floor",
                "sign",
                "atan",
                "log",
                "sin",
                "atn2",
                "log10",
                "sqrt",
                "ceiling",
                "pi",
                "square",
                "cos",
                "power",
                "tan",
                "cot",
                "radians",
                "choose",
                "iif",
                "@@procid",
                "index_col",
                "app_name",
                "indexkey_property",
                "applock_mode",
                "indexproperty",
                "applock_test",
                "next value for",
                "assemblyproperty",
                "object_definition",
                "col_length",
                "object_id",
                "col_name",
                "object_name",
                "columnproperty",
                "object_schema_name",
                "database_principal_id",
                "objectproperty",
                "databasepropertyex",
                "objectpropertyex",
                "db_id",
                "original_db_name",
                "db_name",
                "parsename",
                "file_id",
                "schema_id",
                "file_idex",
                "schema_name",
                "file_name",
                "scope_identity",
                "filegroup_id",
                "serverproperty",
                "filegroup_name",
                "stats_date",
                "filegroupproperty",
                "type_id",
                "fileproperty",
                "type_name",
                "fulltextcatalogproperty",
                "typeproperty",
                "fulltextserviceproperty",
                "version",
                "rank",
                "ntile",
                "dense_rank",
                "row_number",
                "opendatasource",
                "openjson",
                "openquery",
                "openrowset",
                "openxml",
                "certencoded",
                "pwdcompare",
                "certprivatekey",
                "pwdencrypt",
                "current_user",
                "schema_id",
                "database_principal_id",
                "schema_name",
                "fn_builtin_permissions",
                "session_user",
                "fn_get_audit_file",
                "suser_id",
                "fn_my_permissions",
                "suser_sid",
                "has_perms_by_name",
                "suser_sname",
                "is_member",
                "system_user",
                "is_rolemember",
                "suser_name",
                "is_srvrolemember",
                "user_id",
                "original_login",
                "user_name",
                "permissions",
                "$partition",
                "error_procedure",
                "@@error",
                "error_severity",
                "@@identity",
                "error_state",
                "@@pack_received",
                "formatmessage",
                "@@rowcount",
                "get_filestream_transaction_context",
                "@@trancount",
                "getansinull",
                "binary_checksum",
                "host_id",
                "checksum",
                "host_name",
                "compress",
                "isnull",
                "connectionproperty",
                "isnumeric",
                "context_info",
                "min_active_rowversion",
                "current_request_id",
                "newid",
                "current_transaction_id",
                "newsequentialid",
                "decompress",
                "rowcount_big",
                "error_line",
                "session_context",
                "error_message",
                "session_id",
                "error_number",
                "xact_state",
                "textptr",
                "textvalid"
            };

            return builtin.Contains(func.ToLower());
        }
    }
}
